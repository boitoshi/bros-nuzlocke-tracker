# 📱 Codespace SSH接続ガイド（パブリック版）

このドキュメントでは、GitHub CodespaceにTermiusとTailscaleを使って安全にリモート接続する方法を説明します。

⚠️ **注意**: このドキュメントには機密情報は含まれていません。実際の接続には管理者から個別に提供される認証情報が必要です。

## 🌟 概要

- **接続方法**: Tailscale VPN + SSH
- **対象アプリ**: Termius（推奨）
- **対応デバイス**: iOS, Android, Windows, Mac
- **セキュリティ**: VPN + SSH鍵認証

## 📋 必要なもの

### 1. Tailscaleアカウント
- Codespacesで使用しているのと**同じアカウント**
- 無料プランで十分

### 2. Termiusアプリ
- **iOS**: App Store「Termius」
- **Android**: Google Play「Termius」
- **Windows/Mac**: https://termius.com/

## 🔧 初期セットアップ

### Step 1: Tailscaleインストール・ログイン

1. 使用するデバイスにTailscaleアプリをインストール
2. Codespacesと**同じアカウント**でログイン
3. VPNネットワークに接続

### Step 2: 接続情報の取得

管理者から以下の情報を取得してください：

```
Host名: [管理者から提供]
IPアドレス: [TailscaleのIPアドレス]
ポート: [SSHポート番号]
ユーザー名: [SSH接続用ユーザー名]
```

## 🔐 認証設定

### 🔑 方法1: SSH鍵認証（推奨）

#### 秘密鍵の取得
1. 管理者にSSH秘密鍵を要求
2. 安全な方法で秘密鍵を受け取る
3. Termiusアプリにインポート

#### Termiusでの設定
1. **Authentication** → **Use SSH Key**
2. **Import private key**を選択
3. 提供された秘密鍵を**全文コピペ**
4. キー名: 適当な識別名

### 🔒 方法2: パスワード認証

#### Termiusでの設定
1. **Authentication** → **Use Password**
2. **Password**: 管理者から提供されたパスワード
3. より簡単だが、セキュリティは鍵認証より劣る

## 📱 Termius接続設定

### 新しいホスト作成

1. **Termiusアプリ**を開く
2. **＋ New Host**をタップ
3. 管理者から提供された情報を入力：

```
Host name: [任意の名前]
Address: [提供されたIPアドレス]
Port: [提供されたポート番号]
Username: [提供されたユーザー名]
Authentication: [指定された認証方法]
```

### 接続テスト

1. **Connect**ボタンをタップ
2. 初回接続時はホストキーの確認ダイアログが表示される
3. **Accept**で接続完了

## ⚠️ 重要な注意事項

### Codespaceの自動スリープ

#### スリープ条件
- **30分間非アクティブ**で自動スリープ
- VS CodeやTerminalを閉じると非アクティブ状態
- SSH接続だけではアクティブ状態を維持できない

#### スリープ中の状態
- ❌ SSH接続：不可
- ❌ Tailscale接続：切断
- ✅ ファイル：保存される（データは失われない）

### Codespace復活方法

#### 方法1: GitHub Codespaces
1. 管理者にCodespace起動を依頼
2. または適切な権限がある場合は自分で起動

#### 方法2: VS Code
1. VS CodeでCodespaces拡張機能を使用
2. 該当するCodespaceに接続（権限がある場合）
3. 自動的にCodespaceが起動

## 🛠️ トラブルシューティング

### 接続できない場合

#### 1. Tailscale接続確認
- Tailscaleアプリで接続状態を確認
- 同じネットワークに接続されているかチェック

#### 2. 一般的な解決方法
- **Tailscaleアプリを再起動**
- **管理者にCodespace状態を確認依頼**
- **Termiusのホスト設定を再確認**

### エラーメッセージ別対処法

#### "Connection timeout"
- Codespaceがスリープしている可能性
- 管理者にCodespace起動を依頼

#### "Host key verification failed"
- ホストキーが変更された
- Termiusでホストキーを削除して再接続

#### "Permission denied"
- 認証情報が間違っている
- 管理者に正しい認証情報を確認

## 🔒 セキュリティのベストプラクティス

### SSH鍵の管理
- 秘密鍵は**他人と絶対に共有しない**
- デバイスの紛失時は即座に管理者に報告
- 不要になった鍵は削除

### Tailscaleセキュリティ
- 信頼できるデバイスのみをネットワークに追加
- 不要なデバイスは定期的に削除
- 管理画面で接続ログを確認

### アクセス制御
- GitHubの2FA（二要素認証）を有効化
- 必要最小限のアクセス権限を維持
- 定期的なアクセス権の見直し

## 📊 接続パフォーマンス

### 最適化のヒント
- **Wi-Fi環境**での使用を推奨
- **モバイルデータ**でも利用可能（データ使用量に注意）
- **低遅延**：TailscaleのMagic DNSによる直接接続

### 使用量の目安
- **テキスト編集**: 非常に少ない
- **ファイル転送**: 転送サイズに依存
- **コマンド実行**: 少ない

## 🎯 使用例

### 日常的な開発タスク
```bash
# プロジェクトディレクトリに移動
cd /workspaces/[プロジェクト名]

# Gitの状態確認
git status

# テスト実行
[プロジェクト固有のテストコマンド]

# サーバー起動
[プロジェクト固有の起動コマンド]
```

### メンテナンス作業
```bash
# ログ確認
tail -f log/[ログファイル名]

# 設定確認
cat config/[設定ファイル名]

# 依存関係更新
[パッケージ管理コマンド]
```

## 📞 サポート

### 質問・問題報告
- プロジェクト管理者への連絡
- チーム内のサポートチャンネル

### 参考リンク
- [Tailscale公式ドキュメント](https://tailscale.com/kb/)
- [Termius公式サポート](https://termius.com/support)
- [GitHub Codespaces ドキュメント](https://docs.github.com/codespaces)

## 📝 注意事項

- このドキュメントは一般的な手順を示しています
- 実際の接続には管理者から提供される具体的な情報が必要です
- セキュリティ上の理由により、機密情報はこのドキュメントには含まれていません

---

**最終更新**: 2025年6月18日  
**ドキュメント種別**: パブリック版（機密情報なし）
